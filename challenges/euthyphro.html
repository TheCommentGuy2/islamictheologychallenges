<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>The Euthyphro Dilemma</title>
    <link rel="icon" type="image/png" href="../icons/sparkle.png">
    <link href="https://fonts.googleapis.com/css2?family=Crimson+Pro:wght@400;600;700&family=Work+Sans:wght@300;400;600&display=swap" rel="stylesheet">
    <style>
        :root {
            --bg-deep: #0d0d12;
            --bg-card: #1a1a24;
            --bg-card-hover: #22222f;
            --gold: #d4a843;
            --gold-dim: #8a7230;
            --red: #e05555;
            --red-glow: #e0555533;
            --orange: #e8843a;
            --orange-glow: #e8843a33;
            --blue: #5b9bd5;
            --blue-glow: #5b9bd533;
            --green: #3ecf8e;
            --text-primary: #e8e4df;
            --text-secondary: #9a9aa8;
            --text-muted: #5a5a6a;
            --border: #2a2a3a;
        }

        * { margin: 0; padding: 0; box-sizing: border-box; }

        body {
            font-family: 'Work Sans', sans-serif;
            background: linear-gradient(135deg, #0a0a0f 0%, #1a1a24 100%);
            color: var(--text-primary);
            min-height: 100vh;
            display: flex;
            justify-content: center;
            align-items: center;
            padding: 20px;
            position: relative;
            overflow-x: hidden;
        }

        /* Grain texture */
        body::before {
            content: '';
            position: fixed;
            inset: 0;
            background-image: url("data:image/svg+xml,%3Csvg viewBox='0 0 256 256' xmlns='http://www.w3.org/2000/svg'%3E%3Cfilter id='n'%3E%3CfeTurbulence type='fractalNoise' baseFrequency='0.9' numOctaves='4'/%3E%3C/filter%3E%3Crect width='100%25' height='100%25' filter='url(%23n)' opacity='0.04'/%3E%3C/svg%3E");
            pointer-events: none;
            z-index: 9999;
        }

        .container {
            background: linear-gradient(145deg, var(--bg-card), #16161f);
            padding: 48px 40px;
            border-radius: 16px;
            box-shadow: 0 20px 60px rgba(0,0,0,0.5);
            max-width: 720px;
            width: 100%;
            text-align: center;
            position: relative;
            border: 1px solid var(--border);
        }

        /* Header */
        .header {
            margin-bottom: 32px;
            position: relative;
        }

        .header::after {
            content: '';
            position: absolute;
            bottom: -16px;
            left: 50%;
            transform: translateX(-50%);
            width: 80px;
            height: 1px;
            background: linear-gradient(90deg, transparent, var(--gold), transparent);
        }

        h1 {
            font-family: 'Crimson Pro', serif;
            font-size: 2rem;
            font-weight: 700;
            color: var(--gold);
            letter-spacing: 3px;
            text-transform: uppercase;
            margin-bottom: 8px;
        }

        .subtitle {
            font-size: 0.85rem;
            color: var(--text-muted);
            letter-spacing: 2px;
            text-transform: uppercase;
            font-weight: 300;
        }

        /* Progress bar */
        .progress-container {
            margin: 24px 0;
            padding: 0 20px;
        }

        .progress-bar {
            width: 100%;
            height: 4px;
            background: var(--border);
            border-radius: 2px;
            overflow: hidden;
            position: relative;
        }

        .progress-fill {
            height: 100%;
            background: linear-gradient(90deg, var(--gold-dim), var(--gold));
            transition: width 0.4s cubic-bezier(0.4, 0, 0.2, 1);
            border-radius: 2px;
        }

        .progress-text {
            font-size: 0.75rem;
            color: var(--text-muted);
            margin-top: 8px;
            letter-spacing: 1px;
        }

        .menu-badge {
    position: fixed;
    top: 20px;
    right: 20px;
    z-index: 10000;
}

.menu-btn {
    background: var(--bg-card);
    border: 1px solid var(--border);
    color: var(--text-muted);
    padding: 8px;
    border-radius: 8px;
    cursor: pointer;
    transition: all 0.2s;
    display: flex;
    align-items: center;
}

.menu-btn img {
    width: 20px;
    height: 20px;
    opacity: 0.7;
}

.menu-btn:hover {
    border-color: var(--gold);
}

.menu-btn:hover img {
    opacity: 1;
}

.menu-popup {
    display: none;
    position: fixed;
    top: 70px;
    right: 20px;
    background: linear-gradient(145deg, var(--bg-card), #16161f);
    border: 1px solid var(--border);
    border-radius: 12px;
    padding: 20px;
    max-width: 320px;
    max-height: 80vh;
    overflow-y: auto;
    box-shadow: 0 10px 30px rgba(0,0,0,0.5);
    z-index: 10000;
}

.menu-popup.show {
    display: block;
    animation: fadeSlideIn 0.3s ease;
}

.menu-section {
    margin-bottom: 16px;
}

.menu-section:last-child {
    margin-bottom: 0;
}

.menu-section p {
    color: var(--text-secondary);
    font-size: 0.85rem;
    line-height: 1.6;
    margin-bottom: 8px;
}

.menu-section p:last-child {
    margin-bottom: 0;
}

.menu-section strong {
    color: var(--text-primary);
    font-size: 0.9rem;
}

.menu-section a {
    color: var(--gold);
    text-decoration: none;
    transition: color 0.2s;
}

.menu-section a:hover {
    color: var(--text-primary);
}

.menu-divider {
    height: 1px;
    background: var(--border);
    margin: 16px 0;
}

.menu-close {
    position: absolute;
    top: 10px;
    right: 10px;
    background: none;
    border: none;
    color: var(--text-muted);
    font-size: 1.2rem;
    cursor: pointer;
    padding: 4px 8px;
}

.menu-close:hover {
    color: var(--gold);
}

/* Google Translate styling within menu */
#google_translate_element {
    margin-top: 8px;
}

.goog-te-banner-frame.skiptranslate {
    display: none !important;
}

body {
    top: 0px !important;
}

.goog-te-gadget {
    font-family: 'Work Sans', sans-serif !important;
}

.goog-te-gadget-simple {
    background-color: rgba(255,255,255,0.05) !important;
    border: 1px solid var(--border) !important;
    border-radius: 6px !important;
    padding: 6px 10px !important;
    font-size: 0.8rem !important;
    color: var(--text-primary) !important;
    width: 100% !important;
}

.goog-te-gadget-simple:hover {
    border-color: var(--gold) !important;
}

.goog-te-gadget-simple .goog-te-menu-value span {
    color: var(--text-primary) !important;
}

.goog-te-gadget-icon {
    display: none !important;
}



@media (max-width: 768px) {
    .menu-badge {
        top: auto;
        bottom: 20px;
        right: auto;
        left: 20px;
    }
    
    .menu-popup {
        top: auto;
        bottom: 70px;
        right: auto;
        left: 20px;
        max-width: calc(100vw - 40px);
    }
}

        /* Content area */
        #step-content {
            animation: fadeSlideIn 0.5s cubic-bezier(0.22, 1, 0.36, 1);
        }

        @keyframes fadeSlideIn {
            from { opacity: 0; transform: translateY(20px); }
            to { opacity: 1; transform: translateY(0); }
        }

        .step-title {
            font-family: 'Crimson Pro', serif;
            font-size: 1.6rem;
            font-weight: 600;
            margin-bottom: 20px;
            color: var(--text-primary);
            line-height: 1.3;
        }

        .content {
            font-size: 1.1rem;
            line-height: 1.7;
            color: var(--text-secondary);
            margin-bottom: 32px;
            min-height: 70px;
            font-weight: 300;
        }

        .content b {
            color: var(--text-primary);
            font-weight: 600;
        }

        .content i {
            color: var(--gold);
        }

        /* Tooltip */
        .info-tooltip {
            display: inline-block;
            width: 18px;
            height: 18px;
            background: var(--gold-dim);
            color: var(--bg-deep);
            border-radius: 50%;
            font-size: 0.75rem;
            line-height: 18px;
            text-align: center;
            cursor: help;
            margin-left: 6px;
            font-weight: bold;
            position: relative;
        }

        .info-tooltip:hover::after {
            content: attr(data-tooltip);
            position: absolute;
            bottom: 28px;
            left: 50%;
            transform: translateX(-50%);
            background: var(--bg-card-hover);
            color: var(--text-primary);
            padding: 10px 14px;
            border-radius: 6px;
            font-size: 0.85rem;
            white-space: nowrap;
            border: 1px solid var(--border);
            z-index: 10;
            box-shadow: 0 4px 12px rgba(0,0,0,0.4);
            font-weight: 300;
        }

        /* Options */
        .options {
            display: flex;
            flex-direction: column;
            gap: 12px;
        }

        button {
            padding: 16px 24px;
            font-size: 1rem;
            font-family: 'Work Sans', sans-serif;
            border: 1.5px solid var(--border);
            background: var(--bg-card);
            color: var(--text-primary);
            border-radius: 10px;
            cursor: pointer;
            transition: all 0.25s cubic-bezier(0.4, 0, 0.2, 1);
            font-weight: 400;
            letter-spacing: 0.3px;
        }

        button:hover {
            background: var(--bg-card-hover);
            border-color: var(--gold);
            box-shadow: 0 0 20px var(--gold-dim);
            transform: translateY(-2px);
        }

        button:active {
            transform: translateY(0);
        }

        /* Pathway badges */
        .badge {
            display: inline-block;
            font-size: 0.7rem;
            padding: 3px 8px;
            border-radius: 4px;
            margin-left: 8px;
            font-weight: 600;
            letter-spacing: 1px;
            text-transform: uppercase;
        }

        .badge-loop { background: var(--orange-glow); color: var(--orange); }
        .badge-fail { background: var(--red-glow); color: var(--red); }
        .badge-progress { background: var(--blue-glow); color: var(--blue); }

        /* Controls */
        .controls {
            margin-top: 36px;
            display: flex;
            justify-content: space-between;
            border-top: 1px solid var(--border);
            padding-top: 20px;
        }

        .control-btn {
            background: none;
            border: none;
            color: var(--text-muted);
            font-size: 0.85rem;
            cursor: pointer;
            padding: 8px 12px;
            font-family: 'Work Sans', sans-serif;
            transition: color 0.2s;
            letter-spacing: 0.5px;
        }

        .control-btn:hover {
            color: var(--gold);
            background: none;
            transform: none;
            box-shadow: none;
        }

        /* Conceded state */
        .conceded {
            color: var(--red);
            font-weight: 700;
            font-size: 2.2rem;
            margin-top: 24px;
            display: block;
            animation: pulse 2s ease-in-out infinite;
            font-family: 'Crimson Pro', serif;
            letter-spacing: 4px;
        }

        @keyframes pulse {
            0%, 100% { opacity: 1; }
            50% { opacity: 0.6; }
        }

        /* Conclusion box */
        .conclusion-box {
            background: linear-gradient(135deg, #1e1e2a, #16161f);
            border: 1px solid var(--red);
            border-radius: 10px;
            padding: 20px;
            margin-top: 20px;
            box-shadow: 0 0 20px var(--red-glow);
        }

        .conclusion-box p {
            font-size: 0.95rem;
            line-height: 1.6;
            color: var(--text-secondary);
            margin: 0;
        }

        /* Mobile responsive */
        @media (max-width: 600px) {
            .container {
                padding: 32px 24px;
            }

            h1 {
                font-size: 1.5rem;
            }

            .step-title {
                font-size: 1.3rem;
            }

            .content {
                font-size: 1rem;
            }

            button {
                font-size: 0.95rem;
                padding: 14px 20px;
            }
        }
    </style>
</head>
<body>
<div class="menu-badge">
    <button class="menu-btn" onclick="toggleMenu()">
        <img src="icons/menu.png" alt="Menu">
    </button>
    <div class="menu-popup" id="menuPopup">
        <button class="menu-close" onclick="toggleMenu()">×</button>
        
        <div class="menu-section">
            <p><strong><img src="icons/language.png" alt="Language" style="width: 16px; height: 16px; vertical-align: middle; margin-right: 4px;  "> Language</strong></p>
            <div id="google_translate_element"></div>
        </div>
        
        <div class="menu-divider"></div>
        
        <div class="menu-section">
            <p><strong>Icon Credits</strong></p>
            <p>Sparkle icon by <a href="https://www.flaticon.com/free-icons/sparkle" target="_blank" rel="noopener">kornkun - Flaticon</a></p>
            <p>Menu icon by <a href="https://www.flaticon.com/free-icons/menu" target="_blank" rel="noopener">Cloud Nine - Flaticon</a></p>
            <p>Language icon by <a href="https://www.flaticon.com/free-icons/extensible-markup-language" target="_blank" rel="noopener">Freepik - Flaticon</a></p>
        </div>
    </div>
</div>
<div class="container">
    <div class="header">
        <h1>The Euthyphro Dilemma</h1>
        <div class="subtitle">Can God Ground Objective Morality?</div>
    </div>

    <div class="progress-container">
        <div class="progress-bar">
            <div class="progress-fill" id="progressBar" style="width: 0%;"></div>
        </div>
        <div class="progress-text" id="progressText">Step 1 of 8</div>
    </div>

    <div id="step-content">
        <!-- Dynamic Content -->
    </div>
</div>

<script>
    const logicTree = {
        home: {
            title: "The Euthyphro Dilemma",
            text: `<div style="text-align: left; max-width: 640px; margin: 0 auto;">
                <p style="margin-bottom: 16px; line-height: 1.8;">The <b>Euthyphro Dilemma</b>, posed by Plato over 2,000 years ago, asks a fundamental question: <i>"Is something good because God commands it, or does God command it because it is good?"</i></p>
                
                <p style="margin-bottom: 16px; line-height: 1.8;">This presents a logical problem for the argument that <b>objective morality requires God's existence</b>. If goodness is defined by God's will, morality becomes arbitrary. If goodness exists independently of God, then God is not its source.</p>
                
                <p style="margin-bottom: 16px; line-height: 1.8;">Theists often appeal to <i>"God's nature"</i> as a third option — claiming God's nature is necessarily good, thus avoiding arbitrariness while maintaining divine grounding. Others appeal to God's attributes like Wisdom, Justice, and Mercy.</p>
                
                <p style="margin-bottom: 16px; line-height: 1.8;">This tool systematically examines these responses and demonstrates that they still collapse into one horn of the dilemma or fall into circular reasoning. Every logical path is explored — you decide which positions to defend, and the logic reveals the consequences.</p>
                
                <div style="background: linear-gradient(135deg, #2a1a1a, #1e1616); border: 1px solid var(--red); border-radius: 8px; padding: 16px; margin: 20px 0; box-shadow: 0 0 15px var(--red-glow);">
                    <p style="font-size: 0.9rem; color: var(--red); margin: 0; font-weight: 600;">
                        ⚠️ <b>Content Warning:</b> This challenge uses rape as an example of objective moral evil to test logical consistency. The discussion is philosophical and analytical, not graphic, but the topic is present throughout.
                    </p>
                </div>
            </div>`,
            options: [
                { label: "Begin the Challenge", next: "start", badge: "progress" }
            ],
            isHome: true
        },
        start: {
            title: "Premise 1",
            text: "Is God 100% the sole source of morality? (i.e., humans cannot define it independently)",
            tooltip: "This establishes whether morality is entirely dependent on God's will or can exist apart from Him.",
            options: [
                { label: "Yes", next: "p2", badge: "progress" },
                { label: "No", next: "fail_p1", badge: "fail" }
            ],
            step: 1, total: 8
        },
        fail_p1: {
            title: "Premise Rejected",
            text: "If God is not the sole source, then morality can exist without Him — through reason, evolution, social contract, or human flourishing. The argument that objective morality requires God collapses immediately.",
            conclusion: "You have conceded that morality does not require God as its foundation. Objective morality cannot be proof for God's existence.",
            isEnd: true
        },
        p2: {
            title: "Premise 2",
            text: "Is morality concerned with human behavior and how we treat one another?",
            tooltip: "If morality has no bearing on actions, then concepts like sin, virtue, or justice become meaningless.",
            options: [
                { label: "Yes", next: "p3", badge: "progress" },
                { label: "No", next: "fail_p2", badge: "fail" }
            ],
            step: 2, total: 8
        },
        fail_p2: {
            title: "Premise Rejected",
            text: "If morality is not about behavior, then the concepts of 'sin,' 'righteousness,' and 'justice' are meaningless in practice. A morality disconnected from actions has no practical application.",
            conclusion: "You have abandoned moral realism. Without behavior as the subject of morality, there is nothing to debate.",
            isEnd: true
        },
        p3: {
            title: "Premise 3",
            text: "Is rape a morally significant action? (i.e., objectively wrong)",
            tooltip: "This tests whether you accept that some actions have inherent moral weight — a cornerstone of objective morality.",
            options: [
                { label: "Yes", next: "p4", badge: "progress" },
                { label: "No", next: "fail_p3", badge: "fail" }
            ],
            step: 3, total: 8
        },
        fail_p3: {
            title: "Premise Rejected",
            text: "If rape has no inherent moral significance, then no action does. You have rejected the foundation of objective morality entirely. There is nothing left to argue.",
            conclusion: "Without accepting that any action is objectively wrong, you cannot defend objective morality. The argument ends here.",
            isEnd: true
        },
        p4: {
            title: "The Dilemma (Premise 4)",
            text: "If God commanded tomorrow that rape must be mandatory (or is not evil), would it become Good?",
            tooltip: "This is the heart of the Euthyphro Dilemma. Your answer reveals whether morality is arbitrary (based on God's will) or independent (based on a standard outside God).",
            options: [
                { label: "Yes, it would be Good", next: "fail_arbitrary", badge: "fail" },
                { label: "No, it would still be Bad", next: "fail_external", badge: "fail" },
                { label: "God would never do that. His nature is Good.", next: "p5", badge: "progress" }
            ],
            step: 4, total: 8
        },
        fail_arbitrary: {
            title: "Conclusion: Arbitrary Morality",
            text: "Then 'Good' simply means 'whatever God says.' That is obedience to authority, not objective morality. If God's commands define morality, then morality is entirely subjective to God's will — making it arbitrary, not objective.",
            conclusion: "You have conceded that morality is not objective. It is simply obedience. Objective morality cannot be proof for God.",
            isEnd: true
        },
        fail_external: {
            title: "Conclusion: External Standard",
            text: "Then there is a standard of 'Good' — such as harm, justice, or fairness — that overrides God's command. This means goodness exists independently of God. God is not the source of morality; He is merely aligned with it.",
            conclusion: "You have conceded that morality exists outside of God. Objective morality cannot be proof for God's existence.",
            isEnd: true
        },
        p5: {
            title: "The Nature Defense (Premise 5)",
            text: "You appeal to God's nature. So I ask: Is God's nature Good because it aligns with Goodness, or is it Good simply because it is His nature?",
            tooltip: "This is the second horn of the Euthyphro Dilemma. Both answers lead to a logical problem.",
            options: [
                { label: "It is Good because it aligns with Goodness", next: "fail_external_loop", badge: "fail" },
                { label: "It is Good because it is His nature", next: "tautology", badge: "progress" },
                { label: "Neither — His nature IS Goodness itself", next: "identity_collapse", badge: "progress" }
            ],
            step: 5, total: 8
        },
        fail_external_loop: {
            title: "Conclusion: External Standard",
            titleRepeat: "Conclusion: External Standard (Again)",
            text: "If His nature 'aligns' with Goodness, then Goodness is a standard that exists independently of Him. You are back to the same problem: morality is not grounded in God — it is grounded in something else that God happens to follow.",
            conclusion: "Goodness exists outside God. Objective morality cannot be proof for God.",
            isEnd: true,
            isExternalLoop: true
        },
        identity_collapse: {
            title: "The Identity Claim",
            text: "You claim that God's nature doesn't just 'align with' or 'define' Goodness — but that His nature literally <b>IS</b> Goodness itself. They are identical.<br><br>But this raises a critical question: When you say 'His nature IS Goodness,' what does the word 'Goodness' mean?<br><br><b>Does 'Goodness' have any meaning independent of God, or does it just mean 'whatever God's nature happens to be'?</b>",
            tooltip: "Claiming identity doesn't escape the dilemma. You must still explain what 'Goodness' means in this equation.",
            options: [
                { label: "'Goodness' has independent meaning that His nature instantiates", next: "fail_external_loop", badge: "fail" },
                { label: "'Goodness' just means 'God's nature' — nothing more", next: "tautology", badge: "progress" }
            ],
            step: 6, total: 9
        },
        tautology: {
            title: "The Tautology Problem",
            text: "If 'Good' is defined strictly as 'God's nature,' then the sentence 'God is Good' reduces to 'God is God's nature.' It tells us nothing about moral quality — it is a tautological statement with no independent meaning.<br><br><b>Common theistic response:</b> <i>'But His nature is Necessarily Good.'</i><br><br><b>Do you accept this is tautological, or do you want to clarify what 'Necessarily Good' means?</b>",
            tooltip: "A tautology is a circular definition that provides no new information. Saying 'God is Good' becomes equivalent to saying 'X = X.'",
            options: [
                { label: "I accept this is tautological", next: "accept_tautology_early", badge: "fail" },
                { label: "Clarify what 'Necessarily Good' means", next: "necessity_clarification", badge: "progress" }
            ],
            step: 7, total: 9
        },
        accept_tautology_early: {
            title: "Conclusion: Tautology Admitted",
            text: "You have conceded that 'God is Good' is a tautology with no independent moral content. This means 'objective morality' in this framework is just circular word games. It provides no actual guidance, no real standard, and no meaningful foundation for ethics.",
            conclusion: "You have admitted that 'Good' has no meaning beyond 'whatever God is.' This is not objective morality. Objective morality cannot be proof for God.",
            isEnd: true
        },
        necessity_clarification: {
            title: "Clarifying 'Necessarily Good'",
            text: "Wait. If 'Good' just means 'His nature,' then saying 'His nature is necessarily Good' just means <b>'His nature is necessarily His nature.'</b> That's still tautological. It tells us nothing.<br><br>Unless... you're now appealing to some independent standard of Goodness that His nature necessarily aligns with. But we already addressed that in Premise 5.<br><br><b>So which is it?</b>",
            tooltip: "This forces them to clarify: is 'Good' still defined as 'His nature' (tautology) or is there now an external standard (independence)?",
            options: [
                { label: "'Good' means 'His nature' — nothing more", next: "necessity", badge: "progress" },
                { label: "There is an independent standard He aligns with", next: "fail_external_loop", badge: "fail" }
            ],
            step: 8, total: 9
        },
        necessity: {
            title: "Conclusion: Meaningless Tautology",
            text: "You have just admitted that 'Good' is merely a label for 'God's nature' with no independent meaning. This tells us <b>nothing about morality.</b><br><br>Saying 'God is Good' is equivalent to saying 'God is God's nature.' It provides zero moral information. It does not tell us why rape is wrong, why justice matters, or what we ought to do. It is an empty definitional statement.<br><br>Objective morality requires that 'Good' has actual meaning. You have admitted it does not. The argument collapses here.<br><br><b>How do you respond?</b>",
            tooltip: "A tautology with no independent meaning cannot ground objective morality. It is just word games.",
            options: [
                { label: "But God has Wisdom, Mercy, and Justice!", next: "loop_wisdom", badge: "loop" },
                { label: "It is an axiom. It just IS.", next: "fail_axiom", badge: "fail" },
                { label: "We cannot question God.", next: "fail_faith", badge: "fail" },
                { label: "I accept this. The tautology tells us nothing.", next: "accept_tautology", badge: "fail" }
            ],
            step: 9, total: 10
        },
        accept_tautology: {
            title: "Conclusion: Tautology Admitted",
            text: "You have conceded that 'Good = God's nature' is a tautology with no independent moral content. This means 'objective morality' in your framework is just circular word games. It provides no actual guidance, no real standard, and no meaningful foundation for ethics.",
            conclusion: "You have admitted that 'Good' has no meaning beyond 'whatever God is.' This is not objective morality. Objective morality cannot be proof for God.",
            isEnd: true
        },
        loop_wisdom: {
            title: "The Wisdom Loop",
            text: "You appeal to Wisdom, Mercy, and Justice. But I ask: <b>What makes Wisdom and Justice 'Good'?</b><br><br>Choose your answer:",
            tooltip: "Appealing to other attributes just pushes the question back one step. It does not solve the fundamental problem.",
            options: [
                { label: "Because they align with God's nature", next: "p5", badge: "loop" },
                { label: "They are inherently Good (independent of God)", next: "fail_external_loop", badge: "fail" },
                { label: "God decides what they mean", next: "fail_arbitrary_attributes", badge: "fail" },
                { label: "They just ARE. It's an axiom.", next: "fail_axiom", badge: "fail" }
            ],
            step: 10, total: 10
        },
        fail_arbitrary_attributes: {
            title: "Conclusion: Arbitrary Definitions",
            text: "If God decides what 'Wisdom,' 'Justice,' and 'Mercy' mean, then these concepts are arbitrary definitions, not objective standards. You appealed to these attributes to ground morality, but if God can define them as anything He wishes, then they provide no independent moral foundation.<br><br>This is the same problem as Divine Command Theory: morality becomes whatever God decides to call it. 'Justice' could mean anything. 'Wisdom' could mean anything. These are just labels with no fixed meaning — making morality arbitrary, not objective.",
            conclusion: "You have conceded that God's attributes are arbitrarily defined. Morality based on arbitrary definitions is not objective morality. Objective morality cannot be proof for God.",
            isEnd: true
        },
        fail_axiom: {
            title: "Conclusion: Circular Reasoning",
            text: "Axioms are not proofs. Simply asserting 'God is Good' as a starting point is circular reasoning. You are defining God as good and then using that definition to prove morality comes from God. Circular reasoning cannot function as objective proof.",
            conclusion: "You have admitted the argument rests on an unprovable assumption. Objective morality cannot be logical proof for God.",
            isEnd: true
        },
        fail_faith: {
            title: "Conclusion: Faith, Not Logic",
            text: "Declaring that we 'cannot question God' is an abandonment of logic. You cannot use logic to prove God exists (via the Objective Morality Argument) and then ban logic when it questions God. That is intellectual inconsistency.",
            conclusion: "You have abandoned the logical framework. Faith is not proof. Objective morality cannot be logical proof for God.",
            isEnd: true
        }
    };

    let historyStack = [];
    let currentStep = 'home';
    let loopCounter = 0; // Track how many times they return to P5 from loop_wisdom
    let cameFromLoop = false; // Track if we came from loop_wisdom
    let visitedExternalLoop = false; // Track if user has seen fail_external_loop specifically

    const stepContent = document.getElementById('step-content');
    const progressBar = document.getElementById('progressBar');
    const progressText = document.getElementById('progressText');

    function renderStep(stepId) {
        const step = logicTree[stepId];
        
        // Determine which title to use ONLY for fail_external_loop
        // Check the flag BEFORE marking as visited
        let displayTitle = step.title;
        if (step.isExternalLoop && visitedExternalLoop && step.titleRepeat) {
            displayTitle = step.titleRepeat;
        }
        
        // Update progress (hide for home screen)
        if (step.isHome) {
            progressBar.style.width = '0%';
            progressText.textContent = '';
            document.querySelector('.progress-container').style.display = 'none';
        } else {
            document.querySelector('.progress-container').style.display = 'block';
            if (step.step && step.total) {
                const progress = (step.step / step.total) * 100;
                progressBar.style.width = progress + '%';
                progressText.textContent = `Step ${step.step} of ${step.total}`;
            } else {
                progressBar.style.width = '100%';
                progressText.textContent = 'Conclusion';
            }
        }

        let optionsHtml = '';
        if (step.options) {
            step.options.forEach(opt => {
                let badgeHtml = '';
                if (opt.badge) {
                    badgeHtml = `<span class="badge badge-${opt.badge}"></span>`;
                }
                optionsHtml += `<button onclick="handleOption('${opt.next}')">${opt.label}${badgeHtml}</button>`;
            });
        }

        let tooltipHtml = '';
        if (step.tooltip) {
            tooltipHtml = `<span class="info-tooltip" data-tooltip="${step.tooltip}">?</span>`;
        }

        // Add loop warning ONLY if at P5 AND came from loop_wisdom
        let loopWarningHtml = '';
        if (stepId === 'p5' && cameFromLoop) {
            loopCounter++;
            const displayCount = loopCounter;
            const timesText = displayCount === 1 ? 'time' : 'times';
            loopWarningHtml = `
                <div style="background: linear-gradient(135deg, #2a1a1a, #1e1616); border: 1px solid var(--orange); border-radius: 8px; padding: 16px; margin-bottom: 20px; box-shadow: 0 0 15px var(--orange-glow);">
                    <p style="font-size: 0.95rem; color: var(--orange); margin: 0; font-weight: 600;">
                        ⚠️ You have returned to this question ${displayCount === 1 ? 'for the first time' : displayCount + ' ' + timesText}. This is circular reasoning — going in loops without making progress. Every defense brings you back here because the argument for Objective Morality rooted in God is logically incoherent.
                    </p>
                </div>
            `;
        }

        let conclusionHtml = '';
        if (step.isEnd && step.conclusion) {
            conclusionHtml = `
                <div class="conclusion-box">
                    <p><b>What you just proved:</b> ${step.conclusion}</p>
                </div>
                <span class="conceded">✦ CONCEDED ✦</span>
            `;
        }

        let controlsHtml = `
    <div class="controls">
        <button class="control-btn" onclick="goBack()" ${historyStack.length === 0 ? 'style="visibility:hidden;"' : ''}>← Go Back</button>
        <button class="control-btn" onclick="location.href='../index.html'">← All Arguments</button>
        <button class="control-btn" onclick="restart()">Restart ↺</button>
    </div>
`;

        stepContent.innerHTML = `
            ${loopWarningHtml}
            <div class="step-title">${displayTitle}${tooltipHtml}</div>
            <div class="content">${step.text}</div>
            <div class="options">${optionsHtml}</div>
            ${conclusionHtml}
            ${controlsHtml}
        `;

        // Mark that we've visited fail_external_loop AFTER rendering
        // This ensures next time we'll show "(Again)"
        if (step.isExternalLoop) {
            visitedExternalLoop = true;
        }

        // Trigger animation
        stepContent.style.animation = 'none';
        setTimeout(() => {
            stepContent.style.animation = 'fadeSlideIn 0.5s cubic-bezier(0.22, 1, 0.36, 1)';
        }, 10);
    }

    function handleOption(nextStepId) {
        historyStack.push(currentStep);
        
        // Track if we're coming from loop_wisdom to P5
        if (currentStep === 'loop_wisdom' && nextStepId === 'p5') {
            cameFromLoop = true;
        } else {
            cameFromLoop = false;
        }
        
        currentStep = nextStepId;
        renderStep(currentStep);
    }

    function goBack() {
        if (historyStack.length > 0) {
            currentStep = historyStack.pop();
            renderStep(currentStep);
        }
    }

    function restart() {
        historyStack = [];
        currentStep = 'home';
        loopCounter = 0;
        cameFromLoop = false;
        visitedExternalLoop = false;
        renderStep(currentStep);
    }

    renderStep('home');
</script>

<script type="text/javascript">
function googleTranslateElementInit() {
  new google.translate.TranslateElement({
    pageLanguage: 'en',
    includedLanguages: 'ar,ur,tr,fa,id,ms,bn,hi,fr,es,de,ru,zh-CN',
    layout: google.translate.TranslateElement.InlineLayout.SIMPLE,
    autoDisplay: false
  }, 'google_translate_element');
}

function toggleMenu() {
    document.getElementById('menuPopup').classList.toggle('show');
}

// Close menu when clicking outside
document.addEventListener('click', function(event) {
    const popup = document.getElementById('menuPopup');
    const btn = document.querySelector('.menu-btn');
    if (popup && btn && !popup.contains(event.target) && !btn.contains(event.target)) {
        popup.classList.remove('show');
    }
});
</script>
<script type="text/javascript" src="//translate.google.com/translate_a/element.js?cb=googleTranslateElementInit"></script>

</body>
</html>
